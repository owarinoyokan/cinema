#include <iostream>     // –î–ª—è —Ä–∞–±–æ—Ç—ã –ø–æ—Ç–æ–∫–∞ –≤–≤–æ–¥–∞ –∏ –≤—ã–≤–æ–¥–∞
#include <io.h>         // –î–ª—è —Ä–∞–±–æ—Ç—ã —Å _setmode
#include <locale>       // –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ–¥–∏—Ä–æ–≤–∫–∞–º–∏
#include <fcntl.h>      // –î–ª—è —Ä–µ–∂–∏–º–∞ _O_U16TEXT
#include <fstream>      // –î–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏
#include <codecvt>      // –î–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è UTF-16 –≤ wide string
#include <string>       // –î–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å—Ç—Ä–æ–∫–∞–º–∏
#include <sstream>      // –î–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å—Ç—Ä–æ–∫–æ–≤—ã–º–∏ –ø–æ—Ç–æ–∫–∞–º–∏
#include <vector>       // –°–∞–º–∏ –∑–Ω–∞–µ—Ç–µ
#include <windows.h>
#include "Header.h"

using namespace std;    // –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏–º–µ–Ω


void extranceToCinema(); // –§—É–Ω–∫—Ü–∏—è –≤—Ö–æ–¥–∞ –≤ –∫–∏–Ω–æ, –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Å–∞–º—ã–π –ø–µ—Ä–≤—ã–π –≤—ã–±–æ—Ä
void availablePromo(); // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–æ—Å–ø—É–ø–Ω—ã—Ö –∞–∫—Ü–∏–π
void movieSelection(); // –§—É–Ω–∫—Ü–∏—è –≤—ã–≤–æ–¥—è—à–∞—è —Å–ø–∏—Å–æ–∫ —Ñ–∏–ª—å–º–æ–≤ —Å –∫—Ä–∞—Ç–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
void detailedInform(); // –§—É–Ω–∫—Ü–∏—è –≤—ã–≤–æ–¥—è—â–∞—è –¥–µ—Ç–∞–ª–∏ —Ñ–∏–ª—å–º–∞
void choosingPlace(); // –º–µ–Ω—é –≤—ã–±–æ—Ä–∞ –º–µ—Å—Ç–∞
wstring fileIn(const string& fname); // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞ —Å —à–∏—Ä–æ–∫–∏–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏
void sessionSelection(); 


void extranceToCinema() { // –§—É–Ω–∫—Ü–∏—è –≤—Ö–æ–¥–∞ –≤ –∫–∏–Ω–æ, –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Å–∞–º—ã–π –ø–µ—Ä–≤—ã–π –≤—ã–±–æ—Ä
    short int input;
    //wcout << L"\n" << fileIn(" file name ") << endl; // –í—ã–≤–æ–¥ —Ñ–∞–π–ª–∞
    wcout << L"–ß—Ç–æ –≤—ã –∂–µ–ª–∞–µ—Ç–µ —Å–¥–µ–ª–∞—Ç—å?" << endl;
    wcout << L"–ù–∞–∂–º–∏—Ç–µ '1', —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å —Ñ–∏–ª—å–º" << endl;
    wcout << L"–ù–∞–∂–º–∏—Ç–µ '2', —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∞–∫—Ü–∏–∏" << endl;
    wcout << L"–ù–∞–∂–º–∏—Ç–µ '0', —á—Ç–æ–±—ã –≤—ã–π—Ç–∏" << endl;
    wcin >> input;
    system("cls"); // –û—á–∏—Å—Ç–∫–∞ –∫–æ–Ω—Å–æ–ª–∏
    switch (input) {
    case 1:
        movieSelection(); // –§—É–Ω–∫—Ü–∏—è –≤—ã–≤–æ–¥—è—à–∞—è —Å–ø–∏—Å–æ–∫ —Ñ–∏–ª—å–º–æ–≤ —Å –∫—Ä–∞—Ç–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
        break;
    case 2:
        availablePromo(); // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–æ—Å–ø—É–ø–Ω—ã—Ö –∞–∫—Ü–∏–π
        break;
    case 3:
        // –º–µ—Å—Ç–æ –ø–æ–¥ —Ñ-—é –±—É—Ñ–µ—Ç–∞
        break;
    case 0:
        // —á—Ç–æ-—Ç–æ –¥–ª—è –≤—ã—Ö–æ–¥–∞
        break;
    }
}

void availablePromo() { // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–æ—Å–ø—É–ø–Ω—ã—Ö –∞–∫—Ü–∏–π
    short int input;
    //wcout << L"\n" << fileIn(" file name ") << endl; // –í—ã–≤–æ–¥ —Ñ–∞–π–ª–∞
    wcout << L"–°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞–∫—Ü–∏–π ... " << endl;
    wcout << L"–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –∞–∫—Ü–∏–∏, —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ" << endl;
    wcout << L"–ù–∞–∂–º–∏—Ç–µ '0', —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥" << endl;
    wcin >> input;
    system("cls");
    if (input == 0)
        extranceToCinema(); // –í–æ–∑–≤—Ä–∞—Ç –Ω–∞–∑–∞–¥ (–∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏)
    else {
        // –º–µ—Å—Ç–æ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ –≤—ã–≤–æ–¥—è—â–µ–π –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø—Ä–æ –∞–∫—Ü–∏–∏
    }
}

void movieSelection() { // –§—É–Ω–∫—Ü–∏—è –≤—ã–≤–æ–¥—è—à–∞—è —Å–ø–∏—Å–æ–∫ —Ñ–∏–ª—å–º–æ–≤ —Å –∫—Ä–∞—Ç–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
    short int input;
    wcout << L"\n" << fileIn("cimema_info.txt") << endl; // –í—ã–≤–æ–¥ —Ñ–∞–π–ª–∞
    //wcout << L"–°–ø–∏—Å–æ–∫ —Ñ–∏–ª—å–º–æ–≤ —Å –∫—Ä–∞—Ç–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π ... " << endl;
    wcout << L"–ù–∞–∂–º–∏—Ç–µ '1', —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å —Å–µ–∞–Ω—Å" << endl;
    //wcout << L"–ù–∞–∂–º–∏—Ç–µ '2', —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–µ—Ç–∞–ª–∏" << endl; // –í–æ–∑–º–æ–∂–Ω–æ —ç—Ç–æ –Ω–µ —Å—Ç–æ–∏—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ 
                                                                // –∞ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ —Å–µ–∞–Ω—Å–∞

    //wcout << L"–ù–∞–∂–º–∏—Ç–µ '3', —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä" << endl;
    wcout << L"–ù–∞–∂–º–∏—Ç–µ '0', —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥" << endl;
    wcin >> input;
    system("cls");
    switch (input) {
    case 1:
        //choosingPlace(); // –≤—ã–±–æ—Ä —Å–µ–∞–Ω—Å–∞ >> –º–µ–Ω—é –≤—ã–±–æ—Ä–∞ –º–µ—Å—Ç–∞ >> –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –º–µ—Å—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –æ–ø–ª–∞—Ç—ã
        sessionSelection();
        break;
    //case 2:
    //    detailedInform(); // –§—É–Ω–∫—Ü–∏—è –≤—ã–≤–æ–¥—è—â–∞—è –¥–µ—Ç–∞–ª–∏ —Ñ–∏–ª—å–º–∞
    //    break;
    case 3:
        // –º–µ—Å—Ç–æ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ —Ñ–∏–ª—å—Ç—Ä–∞
        break;
    case 0:




        extranceToCinema(); // –í–æ–∑–≤—Ä–∞—Ç –Ω–∞–∑–∞–¥ (–∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏)
        break;
    }
}

void sessionSelection() { // –í—ã–±–æ—Ä —Å–µ–∞–Ω—Å–∞ >> –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ —Å–ª–µ–¥—É–µ—Ç –≤—ã–±–æ—Ä –º–µ—Å—Ç
    wcout << L"\n" << fileIn("cimema_info.txt") << endl; // –í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –æ—Ç–¥–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –Ω–µ –Ω—É–∂–Ω–∞
    short int input;
    //wcout << L"\n" << fileIn("cimema_info.txt") << endl; // –í—ã–≤–æ–¥ —Ñ–∞–π–ª–∞
    wcout << L"–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∏–ª—å–º –∫–æ—Ç–æ—Ä—ã–π —Ö–æ—Ç–∏—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å" << endl;
    wcout << L"–ù–∞–∂–º–∏—Ç–µ '0', —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥" << endl;
    wcin >> input;
    system("cls");
    // –°—é–¥–∞ –≤—Å—Ç–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –≤—ã–≤–æ–¥—è—â—É—é –∫–∏–Ω–æ–∑–∞–ª –ø–æ –≤—ã–±–æ—Ä—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è >> –æ–Ω–∞ –±—É–¥–µ—Ç –≤–µ—Å—Ç–∏ –Ω–∞ choosingPlace()
    if (input == 0)
        movieSelection();
}

void detailedInform() { // –§—É–Ω–∫—Ü–∏—è –≤—ã–≤–æ–¥—è—â–∞—è –¥–µ—Ç–∞–ª–∏ —Ñ–∏–ª—å–º–∞
    short int input;
    wcout << L"\n" << fileIn("film_info.txt") << endl; // –í—ã–≤–æ–¥ —Ñ–∞–π–ª–∞
    wcout << L"–î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø—Ä–æ —Ñ–∏–ª—å–º ... " << endl;
    wcout << L"–ù–∞–∂–º–∏—Ç–µ '0', —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥" << endl;
    wcin >> input;
    system("cls");
    movieSelection(); // –í–æ–∑–≤—Ä–∞—Ç –Ω–∞–∑–∞–¥ (–∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏)
}

void choosingPlace() { // –º–µ–Ω—é –≤—ã–±–æ—Ä–∞ –º–µ—Å—Ç–∞ << –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –º–µ—Å—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –æ–ø–ª–∞—Ç—ã
    short int input;
    wcout << L"\n" << fileIn("places.txt") << endl; // –í—ã–≤–æ–¥ —Ñ–∞–π–ª–∞
    wcout << L"–í—ã–±–µ—Ä–∏—Ç–µ –º–µ—Å—Ç–æ" << endl;
    wcout << L"–ù–∞–∂–º–∏—Ç–µ '1', —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å –æ–¥–Ω–æ –º–µ—Å—Ç–æ" << endl;
    wcout << L"–ù–∞–∂–º–∏—Ç–µ '2', —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å —Å—Ä–∞–∑—É –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Å—Ç" << endl;
    wcout << L"–ù–∞–∂–º–∏—Ç–µ '3', –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥–±–æ—Ä–∞ –º–µ—Å—Ç–∞" << endl;
    wcout << L"–ù–∞–∂–º–∏—Ç–µ '0', —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥" << endl;
    wcin >> input;
    system("cls");
    switch (input) {
    case 1:
        // –º–µ—Å—Ç–æ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ –≤—ã–±–æ—Ä–∞ –º–µ—Å—Ç–∞
        break;
    case 2:
        // –º–µ—Å—Ç–æ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ –≤—ã–±–æ—Ä–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Å—Ç ( –º–æ–∂–Ω–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å —Å 1 )
        break;
    case 3:
        // –º–µ—Å—Ç–æ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ –∞–≤—Ç –ø–æ–¥–±–æ—Ä–∞ –º–µ—Å—Ç–∞ 
        break;
    case 0:
        //movieSelection(); // –í–æ–∑–≤—Ä–∞—Ç –Ω–∞–∑–∞–¥ (–∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏)

        break;
    }
}

// –ó–∞–ø–∏—Å—å —Ç–µ–∫—Å—Ç–∞ –≤ —Ñ–∞–π–ª —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —à–∏—Ä–æ–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤ (UTF-16)
void fileOut(string filename) {

    // –ó–∞–ø—Ä–æ—Å —Ç–µ–∫—Å—Ç–∞ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    wstring input;
    wcout << L"–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç: ";
    getline(wcin, input); // –ß–∏—Ç–∞–µ–º —Å—Ç—Ä–æ–∫—É (–≤–∫–ª—é—á–∞—è –ø—Ä–æ–±–µ–ª—ã)

    // –û—Ç–∫—Ä—ã–≤–∞–µ–º —Ñ–∞–π–ª –≤ –±–∏–Ω–∞—Ä–Ω–æ–º —Ä–µ–∂–∏–º–µ
    ofstream fout(filename, ios::binary);
    if (!fout.is_open()) {
        wcerr << L"–û—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è —Ñ–∞–π–ª–∞ –¥–ª—è –∑–∞–ø–∏—Å–∏." << endl;
        return;
    }

    // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º wstring –≤ UTF-16LE –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ–º
    wstring_convert<codecvt_utf8_utf16<wchar_t, 0x10FFFF, little_endian>> converter;
    string utf16_text = converter.to_bytes(input);
    fout.write(utf16_text.c_str(), utf16_text.size());

    fout.close();
    wcout << L"–í–∞—à —Ç–µ–∫—Å—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–∏—Å–∞–Ω." << endl;
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞ —Å —à–∏—Ä–æ–∫–∏–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏
wstring fileIn(const string& fname) {
    ifstream fin(fname, ios::binary);
    if (!fin.is_open()) {
        wcerr << L"–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª –¥–ª—è —á—Ç–µ–Ω–∏—è." << endl;
        return L"";
    }

    // –ß–∏—Ç–∞–µ–º –æ—Å—Ç–∞–ª—å–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞
    string utf16_content((istreambuf_iterator<char>(fin)), istreambuf_iterator<char>());
    fin.close();

    wstring_convert<codecvt_utf8_utf16<wchar_t, 0x10FFFF, little_endian>> converter;
    return converter.from_bytes(utf16_content);
}


int main() {
    // –£—Å—Ç–∞–Ω–æ–≤–∏–º —Ä–µ–∂–∏–º wide-string –¥–ª—è –≤—ã–≤–æ–¥–∞ –Ω–∞ –∫–æ–Ω—Å–æ–ª—å (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ Unicode)
    _setmode(_fileno(stdout), _O_U16TEXT);
    _setmode(_fileno(stdin), _O_U16TEXT);

    fullScreen();
    system("cls");      // –û—á–∏—Å—Ç–∫–∞ –∫–æ–Ω—Å–æ–ª–∏

    wcout << L"–ü—Ä–æ–µ–∫—Ç –∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä–∞.üé¨" << endl;

    extranceToCinema(); // –§—É–Ω–∫—Ü–∏—è –≤—Ö–æ–¥–∞ –≤ –∫–∏–Ω–æ, –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Å–∞–º—ã–π –ø–µ—Ä–≤—ã–π –≤—ã–±–æ—Ä

    srand(time(0));
    const int rowCount = 8;
    const int placeCount = 18;// 16 –∏ 2 –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –Ω–æ–º–µ—Ä–∞ —Ä—è–¥–∞ —Å –¥–≤—É—Ö —Å—Ç–æ—Ä–æ–Ω
    
    Hall hall;
    GenerationRoom(hall, rowCount, placeCount);
    initializeConsole();
    DrawHall(hall, rowCount, placeCount);
    
    ///–ø—Ä–∏–º–µ—Ä –∑–∞–º–µ–Ω—ã —Å—É—â–µ—Å–≤—É—é—â–µ–≥–æ –º–µ—Å—Ç–∞ –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–æ–∫ –∏–Ω–¥–µ–∫—Å–∞
    /* int changeRow, changePalace;
    cout << "–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ä—è–¥–∞: ";
    cin >> changeRow;
    cout << "\n–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –º–µ—Å—Ç–∞: ";
    cin >> changePalace;
    changePlaces(hall, changeRow, changePalace);
    DrawHall(hall, rowCount, placeCount);*/
    
    
     waitForInput();
     //closeWindow();

    // –ó–∞–ø–∏—Å—å –≤ —Ñ–∞–π–ª
    //fileOut("example.txt");

    // –ß—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
    //wcout << L"–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞: " << fileIn("example.txt") << endl;

    

    return 0;
}

